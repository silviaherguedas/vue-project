<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="Description" content="Extended Description" />
    <meta name="robots" content="index,follow" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Componentes</title>
  </head>
  <body>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <div id="app"></div>

    <script>
      const app = Vue.createApp({
        data() {
          return {
            addPost: {
              title: "",
              description: "",
            },
            add: false,
            openDoor: false,
            posts: [
              {
                title: "Post 1",
                description:
                  "Lorem ipsum dolor sit amet consectetur adipiscing elit vivamus, fringilla mattis aliquet orci volutpat nisl luctus tincidunt sociis, suscipit curabitur nullam egestas turpis penatibus cursus. Convallis fusce inceptos suscipit congue ligula elementum lacus quis, vitae taciti platea habitasse feugiat sapien accumsan, imperdiet blandit commodo luctus ut pharetra ultrices. Imperdiet mollis metus proin sodales dictum libero hendrerit porta porttitor, turpis risus quis non iaculis ullamcorper rutrum curae neque, posuere dignissim lacus auctor pellentesque vitae in litora.",
              },
              {
                title: "Post 2",
                description:
                  "Lorem ipsum dolor sit amet consectetur adipiscing elit vivamus, fringilla mattis aliquet orci volutpat nisl luctus tincidunt sociis, suscipit curabitur nullam egestas turpis penatibus cursus. Convallis fusce inceptos suscipit congue ligula elementum lacus quis, vitae taciti platea habitasse feugiat sapien accumsan, imperdiet blandit commodo luctus ut pharetra ultrices. Imperdiet mollis metus proin sodales dictum libero hendrerit porta porttitor, turpis risus quis non iaculis ullamcorper rutrum curae neque, posuere dignissim lacus auctor pellentesque vitae in litora.",
              },
              {
                title: "Post 3",
                description:
                  "Lorem ipsum dolor sit amet consectetur adipiscing elit vivamus, fringilla mattis aliquet orci volutpat nisl luctus tincidunt sociis, suscipit curabitur nullam egestas turpis penatibus cursus. Convallis fusce inceptos suscipit congue ligula elementum lacus quis, vitae taciti platea habitasse feugiat sapien accumsan, imperdiet blandit commodo luctus ut pharetra ultrices. Imperdiet mollis metus proin sodales dictum libero hendrerit porta porttitor, turpis risus quis non iaculis ullamcorper rutrum curae neque, posuere dignissim lacus auctor pellentesque vitae in litora.",
              },
              {
                title: "Post 4",
                description:
                  "Lorem ipsum dolor sit amet consectetur adipiscing elit vivamus, fringilla mattis aliquet orci volutpat nisl luctus tincidunt sociis, suscipit curabitur nullam egestas turpis penatibus cursus. Convallis fusce inceptos suscipit congue ligula elementum lacus quis, vitae taciti platea habitasse feugiat sapien accumsan, imperdiet blandit commodo luctus ut pharetra ultrices. Imperdiet mollis metus proin sodales dictum libero hendrerit porta porttitor, turpis risus quis non iaculis ullamcorper rutrum curae neque, posuere dignissim lacus auctor pellentesque vitae in litora.",
              },
            ],
            text: "Inicia sesión",
            userName: "",
          };
        },
        computed: {
          styleComputed2() {
            return this.openDoor ? "open" : "closed";
          },
        },
        watch: {
          openDoor(value, oldValue) {
            if (value) {
              this.text = "Cierra sesión";
            } else {
              this.text = "Inicia sesión";
              this.userName = "";
              this.add = false;
            }
          },
        },
        template: `
            <div class="container" :class="styleComputed2">
              <h2>{{ text }}</h2>
              <div v-if="openDoor">
                <p>Hola, {{ userName }}</p>
                <div class="menuLogin">
                  <button @click="add = true">nuevo</button>
                  <button @click="add = false">ver</button>
                </div>
                <div class="containerAdd" v-if="add">
                  <add
                    :addPost="addPost"
                    :posts="posts"
                  />
                  <div id="divDeletePost">
                    <item
                      class="itemDel"
                      v-for="(item, i) in posts"
                      :key="i"
                      :post="item"
                      :index="i"
                      :posts="posts"
                      :withDescription="false"
                    />
                  </div>
                </div>
                <div v-else class="list">
                  <item
                    v-for="(item, i) in posts"
                    :key="i"
                    :post="item"
                    :index="i"
                    :posts="posts"
                    :withDescription="true"
                  />
                </div>
              </div>
              <div v-else>
                <div>User name </div>
                <input type="text" v-model="userName">
              </div>
              <button class="mgt-24" @click="openDoor = !openDoor">
                <div v-if="!openDoor">Acceder</div>
                <div v-else>Salir</div>
              </button>
            </div>
            `,
      });

      app.component("add", {
        props: ["posts", "addPost"],
        methods: {
          AddPostToTheList() {
            this.posts.push({
              title: this.addPost.title,
              description: this.addPost.description,
            });
          },
        },
        template: `
              <div class="addPost">
                <div> T&iacute;tulo </div>
                <input type="text" v-model="addPost.title" />
                <div> Descripci&oacute;n </div>
                <input type="text" v-model="addPost.description" />
                <div class="mgt-24"><button @click="AddPostToTheList">Agregar</button></div>
              </div>
            `,
      });

      app.component("item", {
        props: ["post", "index", "posts", "withDescription"],
        methods: {
          DeletePost(index, element) {
            // mutabilidad aqui seria para no mutar directamente el array
            // let aTemp = this.posts.map(function(item, index){
            //     return item;
            // });
            // aTemp.splice(index, 1);
            // this.posts = aTemp;

            this.posts.splice(index, 1);
            // console.log(index, element, this.posts, aTemp);
          },
        },
        template: `
            <div class="item">
                <div class="title">{{ post.title }}</div>
                <p v-if="withDescription">{{ post.description }}</p>
                <div><button @click="DeletePost(index, post)">borrar</button></div>
            </div>
            `,
      });

      const vm = app.mount("#app");
    </script>

    <style>
      html,
      body {
        height: 100vh;
        margin: 0;
        font-family: Arial, Helvetica, sans-serif;
      }

      #app,
      .container {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        width: 100%;
        height: 100%;
      }

      .mgt-24 {
        margin-top: 24px;
      }

      button {
        border: none;
        background-color: white;
        padding: 8px 24px;
        border-radius: 12px;
      }

      .addPost {
        background-color: #54964a;
        border: 1px solid #ccc;
        padding: 7px;
      }

      .closed {
        background-color: #eca1a6;
      }

      .containerAdd {
        display: flex;
        flex-direction: row;
        gap: 16px;
        width: 100%;
      }

      .open {
        background-color: #b5e7a0;
      }

      .list {
        display: flex;
        flex-direction: column;
      }

      .item {
        border: 1px solid #1c2263;
        padding: 7px;
        margin-bottom: 7px;
      }

      .itemDel {
        border-bottom: 1px solid #1c2263;
        font-size: 14px;
        margin-bottom: 7px;
      }

      .menuLogin {
        align-items: center;
        display: flex;
        flex-direction: row;
        gap: 7px;
        margin-bottom: 7px;
      }

      .title {
        font-weight: bold;
        font-size: 1.5rem;
      }
    </style>
  </body>
</html>
